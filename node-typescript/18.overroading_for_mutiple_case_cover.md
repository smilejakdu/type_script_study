ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ passport-local ì— íƒ€ì´í•‘ì„ ì‘ì„±ì„ í–ˆë‹¤.

ê·¸ë˜ì„œ ì´ê²ƒê³¼ ë‚¨ë“¤ì´ íƒ€ì´í•‘ì„ í•´ë‘”ê²ƒì´ ìˆëŠ”ë° ì´ê²ƒê³¼ ë¹„êµë¥¼ í•´ë³¸ë‹¤.

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/a2dcf5aa-d788-4509-a5d5-dd9d2c766bd7.png)


ì´ë¦„ì€ ìµœëŒ€í•œ ë˜‘ê°™ê²Œ ì§€ì–´ë†“ì€ ìƒíƒœì´ë‹¤ .

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/1b1a9479-bb30-4329-84b6-0dd7a7b2244a.png)


ë‚¨ë“¤ì´ ì‘ì„±í•˜ëŠ”ê²ƒì„ ë´¤ì„ë•Œ

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/a5dd6a24-fa65-4f6e-b93f-317d5709853c.png)


session ê³¼ passReqToCallback ë„ ì¡´ì¬í•œë‹¤ í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ì‘ì„±í• ìˆ˜ê°€ ì—†ë‹¤.


ì‹¤ì œë¡œ ì´ê²ƒë“¤ì´ ì¡´ì¬í• ê²ƒì¸ì§€ ì•ˆí•  ê²ƒì¸ì§€ ì•Œ ìˆ˜ê°€ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.


ë”± ì •í™•í•˜ê²Œ ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ëŠ”ê²ƒë§Œ ì‘ì„±ì„ í•´ì£¼ë©´ ëœë‹¤.


ë°‘ì— ë” ë‚´ë ¤ë³´ë©´

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/f3f7aa95-98ec-44ba-81e6-5dcd281bc8f2.png)


ìƒì„±ìê°€ ì˜¤ë²„ë¡œë”© ë˜ì–´ìˆë‹¤.


í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ìƒì„±ìë¥¼ ìœ„ì—êº¼ë§Œ ì‚¬ìš©í•˜ê³  ìˆë‹¤.


ê·¼ë° í˜¹ì‹œë‚˜ ë‹¤ë¥¸ê³³ì—ì„œ

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/417e661a-5765-408e-8c97-f811bf649e35.png)


ìœ„ì—ê²ƒì´ ì‚¬ìš©í• ìˆ˜ë„ ìˆìœ¼ë‹ˆ ì˜¤ë²„ë¡œë”©ì„ í•´ì¤„ìˆ˜ë„ ìˆë‹¤.


ë§Œì•½ì—


ì¶”ê°€ë¥¼ í•´ë³¸ë‹¤ëŠ” ê°€ì •ì„ í•´ë³´ì .


session ì´ë‘ passReqToCallback ì„ ë„£ì–´ë³¸ë‹¤ê³  í•˜ë©´

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/06a23cfc-3e1e-4b69-8803-b22e371f9b3a.png)


ì—¬ê¸°ì„œ passReqToCallback ì´ë¼ëŠ”ê²Œ ë¬´ì—‡ì´ë‚˜ë©´


ë°‘ì— í•¨ìˆ˜ë¶€ë¶„ì— req ë¥¼ í•˜ë‚˜ì¶”ê°€ë¥¼ í•´ë³¸ë‹¤.

[![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/9dd39089-0b9a-4e75-9cbe-26cbdd0afec4.png)](https://slid.cc/vdocs/e4ee453c32fe494dbd407b752ec4c76b?v=6d4aab471f8d4e99977377247d9f1995&start=166.62714)


ê·¸ëŸ¬ë©´ í•¨ìˆ˜ëª¨ì–‘ì´ ë‹¬ë¼ì§€ê²Œ ëœë‹¤.


í•¨ìˆ˜ëª¨ì–‘ì„ íŒë‹¨í•˜ëŠ” ê¸°ì¤€ì€ íŒŒë¼ë¯¸í„° ì™€ return ì„ ë³´ë©´ í•¨ìˆ˜ëª¨ì–‘ì´ ê°™ì€ì§€ ë‹¤ë¥¸ì§€ íŒë‹¨ì„ í•  ìˆ˜ê°€ ìˆë‹¤.


ê·¸ëŸ°ë° ì§€ê¸ˆ passReqToCallback ì´ë¼ëŠ”ê²ƒì„ ë„£ê²Œ ë˜ë©´ , í•¨ìˆ˜ëª¨ì–‘ì´ ë‹¬ë¼ì§€ê²Œ ëœë‹¤.


ì´ê²ƒì„ ì§€ìš°ê±°ë‚˜ false ë¡œ ë°”ê¾¸ê²Œ ë˜ë©´

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/708f9d32-dce8-46a5-ac38-54773fd70a20.png)



ì•ì—ê·¸ëŸ¼ req ê°€ë¹ ì§€ê²Œ ëœë‹¤.

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/f9f0f40d-62f7-4dac-ad1e-066cdb36a79e.png)


ê·¸ë˜ì„œ ì´ëŸ¬í•œ ì°¨ì´ê°€ ìˆê¸°ë•Œë¬¸ì— ì˜¤ë²„ë¡œë”©ì„ í•´ì•¼í•œë‹¤.


ê°™ì€ ë§¤ê°œë³€ìˆ˜ë¥¼ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì„ ì–¸ì„ í•  ìˆ˜ìˆê²Œ

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/cf625969-806e-4656-a655-023faf209220.png)


ê·¸ë‹¤ìŒì— VerifyFunction ì´ ê°€ì¥ í° ë¬¸ì œì´ë‹¤ .


ì—‡ ë­ê°€ ë¬¸ì œì´ì§€ ??

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/dbdc0a9e-8671-4d53-82dd-1b90219b3af7.png)


ê·¸ëƒ¥ì´ë ‡ê²Œ í•˜ë©´ ë˜ëŠ”ê²ƒì´ ì•„ë‹Œê°€ ?? ë¼ê³  ìƒê°ì´ ë“¤ ìˆ˜ ìˆë‹¤.


ê·¼ë° ì´ë ‡ê²Œí•˜ë©´ ì¸ìê°€ 4ê°œê°€ ë˜ì–´ë²„ë¦°ë‹¤.


ìš°ë¦¬ëŠ” 3ê°œê±°ë‚˜ 4ê°œê°€ ë˜ì–´ì•¼í•˜ëŠ”ë° ê·¸ë ‡ë‹¤ê³  ì•ì— optional ì„ í• ìˆ˜ê°€ ì—†ë‹¤ ì•ì— optional ì„ ì‘ì„±í•˜ê²Œ ë˜ë©´ ë’¤ì—ìˆëŠ”ê²ƒë“¤ë„ optional ì„ ëª¨ë‘ ì ìš©ì‹œì¼œì¤˜ì•¼í•œë‹¤.

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/4b8e4f9a-674c-4fc3-9d8f-c4922c7c8647.png)


ì´ëŸ´ê²½ìš° ì´ì œ ì˜¤ë²„ë¡œë”©ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.


VerifyFunctionWithRequest ë¼ëŠ” interface ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/514a4bea-9cbc-4846-8413-5f2030dddd5b.png)


ê·¸ë¦¬ê³  ì¸ìê°’ìœ¼ë¡œ req : Request ë¥¼ ì¶”ê°€ì‹œì¼œì¤€ë‹¤.

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/dde49948-4d56-41fe-ae9a-404189f0740b.png)


Request ëŠ” express ì—ì„œ ê°€ì ¸ì˜¨ë‹¤.

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/e4ee453c32fe494dbd407b752ec4c76b/6c53df17-c6ef-44ae-89ec-d9fcf0f39ac3.png)


ê·¸ëŸ¬ë©´ì´ì œ VerifyFunction ì„ ì‚¬ìš©í•˜ê±°ë‚˜ , VerifyFunctionWithRequest ë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.


í•¨ìˆ˜ interface ë¥¼ ë‘ê°œ ë§Œë“ ê²ƒì´ ëœë‹¤.


ì•„ë˜ interface VerifyFunctionWithRequest ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ëŠ”ë° ìƒì„±ì ë¶€ë¶„ë¶€í„° ë‹¬ë¼ì§€ê²Œ ëœë‹¤.

![18.ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ ì»¤ë²„ë¥¼ ìœ„í•œ ì˜¤ë²„ë¡œë”© image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/image_upload/e4ee453c32fe494dbd407b752ec4c76b/9ef73a8c-ae30-47ec-ad9b-146cb1763ef8.png)


ì´ëŸ°ì‹ìœ¼ë¡œ ë‹¬ë¼ì§€ê²Œ ëœë‹¤.


options íƒ€ì…ì´ IStrategyOptions ì´ë©´ verify íƒ€ì…ì´ VerifyFunction ë¡œ ë˜ê³ 


options íƒ€ì…ì´ IStrategyOptionsWithRequest ì´ë©´ verify íƒ€ì…ì´ VerifyFunctionWithRequest ë¡œ ëœë‹¤.


# ğŸ“Œì „ì²´ì½”ë“œ


## ğŸ‘‰passport/local.ts

```ts
import * as passport from 'passport';
import * as bcrypt from 'bcrypt';
import { Strategy } from 'passport-local';
import User from '../models/user';

export default () => {
  passport.use('local', new Strategy({
    usernameField: 'userId',
    passwordField: 'password',
    session: false,
    passReqToCallback: true,
  }, async (req, userId, password, done) => {
    try {
      const user = await User.findOne({ where: { userId } });
      if (!user) {
        return done(null, false, { message: 'ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ìì…ë‹ˆë‹¤!' });
      }
      const result = await bcrypt.compare(password, user.password);
      if (result) {
        return done(null, user);
      }
      return done(null, false, { message: 'ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë¦½ë‹ˆë‹¤.' });
    } catch (err) {
      console.error(err);
      return done(err);
    }
  }))
};

```


## ğŸ‘‰types/passport-local.d.ts

```ts
declare module "passport-local" {
  import { Request } from 'express';
  import { Strategy as PassportStrategy } from 'passport';

  export interface IVerifyOptions {
    [key: string]: any;
  }
  export interface IStrategyOptions {
    usernameField: string;
    passwordField: string;
    session?: boolean;
    passReqToCallback?: false;
  }
  export interface IStrategyOptionsWithRequest {
    usernameField: string;
    passwordField: string;
    session?: boolean;
    passReqToCallback: true;
  }
  export interface Done {
    (error: Error | null, user?: any, options?: IVerifyOptions): void;
  }
  export interface VerifyFunction {
    (username: string, password: string, done: Done): void | Promise<any>;
  }
  export interface VerifyFunctionWithRequest {
    (req: Request, username: string, password: string, done: Done): void | Promise<any>;
  }

  export class Strategy extends PassportStrategy {
    constructor(options: IStrategyOptions, verify: VerifyFunction)
    constructor(options: IStrategyOptionsWithRequest, verify: VerifyFunctionWithRequest)
  }
}

```



