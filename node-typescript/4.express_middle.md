# 4ğŸ“Œ middleware 


express ì— í•„ìš”í•œ ëª¨ë“ˆë“¤ì„ ì„¤ì¹˜í•˜ë„ë¡ í•œë‹¤.

```
npm install morgan cors cookie-parser express-session dotenv passport
npm install hpp helmet
```

ì¼ë‹¨ì€ ì´ì •ë„ ì„¤ì¹˜í•˜ë„ë¡ í•œë‹¤.

ê·¸ëŸ¬ë©´ `package.json` ì¶”ê°€ê°€ ëœë‹¤. 

í•˜ì§€ë§Œ ë¬¸ì œì ì´ ëŒ€ë¶€ë¶„ì˜ ëª¨ë“ˆë“¤ì´ íƒ€ì…í•‘ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.

![4.express ë¯¸ë“¤ì›¨ì–´ image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/770dacec058f45b1b4ae389fca3fa8c7/78747bbb-3182-45ad-8760-3304bab2ec50.png)
```
npm i @types/morgan @types/cors @types/cookie-parser
npm i @types/express-session @types/dotenv @types/passport
npm i @types/hpp @types/helmet
npm i passport-local bcrypt @types/bcrypt @types/passport-local
```

ë‹¤ì‹œ ì„¤ì¹˜ë¥¼ í•´ì¤€ë‹¤.

![4.express ë¯¸ë“¤ì›¨ì–´ image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/770dacec058f45b1b4ae389fca3fa8c7/2530fcba-a9b5-457b-a5ec-7bc58695c6ba.png)


ê·¸ë¦¬ê³  ì¤‘ìš”í•œê²Œ ë²„ì „ì´ ì¼ì¹˜í•˜ëŠ”ì§€ ë´ì•¼í•œë‹¤.

![4.express ë¯¸ë“¤ì›¨ì–´ image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/770dacec058f45b1b4ae389fca3fa8c7/d85e8952-c3ec-4af3-b65e-8968c849278c.png)


ì§€ê¸ˆ ë³´ë©´


@types/bcrypt ëŠ” 3.0.0 ë²„ì „ì¸ë°


bcrypt ëŠ” 4.0.1 ë²„ì „ì´ë‹¤.


ì´ëŸ¬ë©´ ì‚´ì§ ìœ„í—˜ì„±ì´ ìˆë‹¤.


ë’¤ì—ëŠ” ë²„ì „ì´ ë‹¬ë¼ë„ í¬ê²Œ ì§€ì¥ì´ ì—†ì§€ë§Œ ë©”ì´ì € ë²„ì „ ì¦‰ ì œì¼ ì•ì—ìˆëŠ ë²„ì „ì´ @types/bcrypt ëŠ” 3 ë²„ì „ì´ê³  ê·¸ëƒ¥ bcrypt ëŠ” 4 ë²„ì „ì´ë‹¤.


## ğŸ‘‰ index.ts ë¯¸ë“¤ì›¨ì–´


![4.express ë¯¸ë“¤ì›¨ì–´ image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/770dacec058f45b1b4ae389fca3fa8c7/7cc56d72-05ae-4b9f-b86e-8b69e6a54d9f.png)


ìš°ë¦¬ê°€ ì„¤ì¹˜í–ˆë˜ê²ƒë“¤ì„ ìš°ì„  ë‹¤ ê°€ì ¸ì˜¤ë„ë¡ í•œë‹¤.


ê·¸ë¦¬ê³  ì´ì œ ì„¤ì •ì„ ìœ„í•œ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.

![4.express ë¯¸ë“¤ì›¨ì–´ image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/image_upload/770dacec058f45b1b4ae389fca3fa8c7/c9629d73-2e56-462a-86ed-cabb67b90271.png)

ê·¸ë¦¬ê³  ì´ì œ

package.json íŒŒì¼ë¡œ ë‹¤ì‹œê°€ì„œ ì‹¤í–‰ scripts ë¥¼ ë°”ê¿”ì¤€ë‹¤.

![4.express ë¯¸ë“¤ì›¨ì–´ image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/770dacec058f45b1b4ae389fca3fa8c7/8b6d294f-510d-4436-9d37-5fcc92f5adeb.png)


ê·¸ë¦¬ê³  ë‹¤ì‹œ index.ts íŒŒì¼ë¡œê°€ì„œ ë§ˆì € ì‘ì„±ì„ í•œë‹¤.

![4.express ë¯¸ë“¤ì›¨ì–´ image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/770dacec058f45b1b4ae389fca3fa8c7/827e6f34-94ed-44da-ad66-537713aada2a.png)

```ts
app.use('/', express.static('uploads'));
app.use(express.json());
app.use(express.urlencoded({ extended: true }));
app.use(cookieParser(process.env.COOKIE_SECRET));
app.use(expressSession({
  resave: false,
  saveUninitialized: false,
  secret: process.env.COOKIE_SECRET!,
  cookie: {
    httpOnly: true,
    secure: false, // https -> true
    domain: prod ? '.nodebird.com' : undefined,
  },
  name: 'rnbck',
}));
app.use(passport.initialize());
app.use(passport.session());

app.get('/', (req, res, next) => {
  res.send('react nodebird ë°±ì—”ë“œ ì •ìƒ ë™ì‘!');
});

app.listen(app.get('port'), () => {
  console.log(`server is running on ${app.get('port')}`);
});
```

## ğŸ‘‰ .env

![4.express ë¯¸ë“¤ì›¨ì–´ image](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/770dacec058f45b1b4ae389fca3fa8c7/5278226f-a792-4954-9178-ab2069c3c5c8.png)


## ğŸ‘‰ ì•Œì•„ê°€ì•¼í• ê²ƒ

- ê·¸ëƒ¥ ë²„ì „ê³¼ @types/ ë˜ì–´ìˆëŠ” ë²„ì „ì´ ê°™ì€ì§€ í™•ì¸í•œë‹¤
- scripts ì‹¤í–‰ ì½”ë“œ 
- index.ts ë¯¸ë“¤ì›¨ì–´ ì„¤ì •
- .env 